---
title: "Obliterate non-removable MDM profiles enforced by Apple's Device Enrollment Program"
date: "2020-09-06"
description: "Or, when life gives you apples, use Linux Seemingly harder to remove with every eye-glazing gist and thread... A mac plagued with an is_mdm_removable=false..."
tags: ["Featured", "Ideas"]
published: true
slug: "1984"
original_url: "https://transscendsurvival.org/2020/09/06/1984/"
feature_image: "/images/posts/IMG_6649-Edit.jpg"
category: "personal"
---

_Or, when life gives you apples, use Linux_

Seemingly [harder to remove](https://gist.github.com/sghiassy/a3927405cf4ffe81242f4ecb01c382ac) with every eye-glazing [gist and thread](https://gist.github.com/henrik242/65d26a7deca30bdb9828e183809690bd)... A mac plagued with an _`is_mdm_removable=false`_ [Mobile Device Management](https://support.apple.com/en-us/HT204142) profile: **the worst!** ðŸ™‚

First, [boot into recovery mode](https://support.apple.com/en-us/HT201314) by rebooting while holding down the `Command` & `R` keys.

At this stage, you'll need to connect to the internet briefly to download the recovery OS. This provides a few tools including like disk utility, support, an osx reinstaller- at the top menu, you'll find an option to access a terminal.

Once in there, you'll want to:

Disable [SIP](https://support.apple.com/en-us/HT204899):

```bash
csrutil disable
```

Then reboot:

```bash
reboot now
```

While holding down `Command` \+ `Option` \+ `P` \+ `R` to start afresh with cleared [NVRAM](https://support.apple.com/en-us/HT204063#:~:text=How%20to%20reset%20NVRAM,Mac%20might%20appear%20to%20restart).

Reboot once again while holding down the `Command` & `R` keys to return to the recovery OS. Reinstall whatever version of OSX it offers- instead of trying to deal with the slippery, network connected DEP plists & binaries contained within the various `LaunchAgents` and `LaunchDaemons` found in the `/System/Library` directories directly, we'll let Apple finish with the `ConfigurationProfiles` first, _then_ sneak in and remove them.

While this stuff is cooking, get yourself a usb stick and a [penguin](https://en.wikipedia.org/wiki/Tux_\(mascot\)), such as [Budgie](https://ubuntubudgie.org/downloads/):

```bash
wget -nd http://cdimage.ubuntu.com/ubuntu-budgie/releases/20.04.1/release/ubuntu-budgie-20.04.1-desktop-amd64.iso
umount /dev/sdc 2>/dev/null || true
sudo dd if=ubuntu-budgie-20.04.1-desktop-amd64.iso of=/dev/sdc bs=1048576 && sync
```

Boot up again, this time holding the `Option` key for the bootloader menu. Once in the live usb system, make sure you can read Apples HFS filesystem:

```bash
sudo apt-get install hfsprogs
```

For me at least, I needed to run a quick `fsck` to fix up the headers before I could mount the osx filesystem living at `/dev/sda2` (`sda1` is the `efi` partition):

```bash
sudo fsck.hfsplus /dev/sda2
```

Now, lets go in there and remove those ConfigurationProfiles:

```bash
mkdir badapple
sudo mount -o force /dev/sda2 badapple
cd badapple
sudo rm -rf private/var/db/ConfigurationProfiles/*
```

ðŸ™‚
